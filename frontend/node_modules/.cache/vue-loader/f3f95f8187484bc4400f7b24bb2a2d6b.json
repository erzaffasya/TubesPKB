{"remainingRequest":"C:\\Users\\ERZA\\Documents\\GitHub\\TubesPKB\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ERZA\\Documents\\GitHub\\TubesPKB\\frontend\\src\\views\\AddEmployee.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\ERZA\\Documents\\GitHub\\TubesPKB\\frontend\\src\\views\\AddEmployee.vue","mtime":1592960214000},{"path":"C:\\Users\\ERZA\\Documents\\GitHub\\TubesPKB\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ERZA\\Documents\\GitHub\\TubesPKB\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\ERZA\\Documents\\GitHub\\TubesPKB\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ERZA\\Documents\\GitHub\\TubesPKB\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBheGlvcyBmcm9tICdheGlvcycKaW1wb3J0IHsgQkZvcm1GaWxlIH0gZnJvbSAnYm9vdHN0cmFwLXZ1ZScKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgICdiLWZvcm0tZmlsZSc6IEJGb3JtRmlsZSwKICB9LAogIGRhdGEgKCkgewogICAgcmV0dXJuIHsKICAgICAgbmlrOiAnJywKICAgICAgbmFtYTogJycsCiAgICAgIHZpZGVvOiB7fSwKICAgICAgY2FudmFzOiB7fSwKICAgICAgY2FwdHVyZXM6IFtdLAogICAgICBpc0NhbWVyYU9wZW46IGZhbHNlLAogICAgICBpc1Bob3RvVGFrZW46IGZhbHNlLAogICAgICBpbWFnZVNhdmVkOiBmYWxzZSwKICAgICAgdmlhVXBsb2FkOiBmYWxzZSwKICAgICAgdmlhTGl2ZTogbnVsbCwKICAgICAgZmlsZToge30sCiAgICB9CiAgfSwKICBjb21wdXRlZDogewogICAgZm9ybUZpbGxlZCAoKSB7CiAgICAgIHJldHVybiB0aGlzLm5payAhPT0gJycgJiYgdGhpcy5uYW1hICE9PSAnJwogICAgfSwKICB9LAogIG1vdW50ZWQgKCkge30sCiAgbWV0aG9kczogewogICAgY2hlY2sgKGUpIHsKICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpCiAgICAgIGlmICh0aGlzLnZpYVVwbG9hZCkgewogICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCkKICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCB0aGlzLmZpbGUpCiAgICAgICAgLy8gWW91IHNob3VsZCBoYXZlIGEgc2VydmVyIHNpZGUgUkVTVCBBUEkKICAgICAgICBheGlvcy5wb3N0KCdodHRwOi8vbG9jYWxob3N0OjUwMDAvYWRkX2VtcGxveWVlX3VwbG9hZC8nICsgdGhpcy5uaWsgKyAnLycgKyB0aGlzLm5hbWEsIGZvcm1EYXRhLCB7IGhlYWRlcnM6IHsgJ0NvbnRlbnQtVHlwZSc6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJyB9IH0pCiAgICAgICAgICAudGhlbigoKSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzdWNjZXNzJykKICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCkKICAgICAgICAgIH0pCiAgICAgICAgICAuY2F0Y2goZSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGUudG9TdHJpbmcoKSkKICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCkKICAgICAgICAgIH0pCiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5zdG9wQ2FtZXJhU3RyZWFtKCkKICAgICAgICBheGlvcwogICAgICAgICAgLmdldCgnaHR0cDovL2xvY2FsaG9zdDo1MDAwL2FkZF9lbXBsb3llZS8nICsgdGhpcy5uaWsgKyAnLycgKyB0aGlzLm5hbWEpCiAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKQogICAgICAgICAgICBhbGVydCgnQWRkaW5nIEVtcGxveWVlIFN1Y2Nlc3MhJykKICAgICAgICAgICAgbG9jYXRpb24ucmVsb2FkKCkKICAgICAgICAgIH0pCiAgICAgIH0KICAgIH0sCiAgICBmb3JtUmVhZHlUb1N1Ym1pdCAoKSB7CiAgICAgIGlmICh0aGlzLnZpYVVwbG9hZCkgewogICAgICAgIC8vIGthbGF1IHZpYSB1cGxvYWQsIHNpYXAgc3VibWl0IGJlcmFydGkgc2VtdWEgZm9ybSB0ZWxhaCBkaWlzaQogICAgICAgIHJldHVybiB0aGlzLm5payAhPT0gJycgJiYgdGhpcy5uYW1hICE9PSAnJyAmJiB0aGlzLmZpbGUKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBrYWxhdSB2aWEgZm90byBsaXZlLCBzaWFwIHN1Ym1pdCBiZXJhcnRpIHNlbXVhIGZvcm0gdGVsYWggZGlpc2kgZGFuIGdhbWJhciB0ZWxhaCB0ZXJzaW1wYW4gZGkgRG93bmxvYWRzCiAgICAgICAgcmV0dXJuIHRoaXMubmlrICE9PSAnJyAmJiB0aGlzLm5hbWEgIT09ICcnICYmIHRoaXMuaW1hZ2VTYXZlZCAmJiB0aGlzLmlzUGhvdG9UYWtlbgogICAgICB9CiAgICB9LAogICAgY2FwdHVyZSAoKSB7CiAgICAgIGNvbnNvbGUubG9nKCdjYXB0dXJlIGltYWdlJykKICAgIH0sCiAgICB0b2dnbGVDYW1lcmEgKCkgewogICAgICBpZiAodGhpcy5pc0NhbWVyYU9wZW4pIHsKICAgICAgICB0aGlzLnZpYUxpdmUgPSBmYWxzZQogICAgICAgIHRoaXMuaXNDYW1lcmFPcGVuID0gZmFsc2UKICAgICAgICB0aGlzLmlzUGhvdG9UYWtlbiA9IGZhbHNlCiAgICAgICAgdGhpcy5zdG9wQ2FtZXJhU3RyZWFtKCkKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnZpYUxpdmUgPSB0cnVlCiAgICAgICAgdGhpcy5pc0NhbWVyYU9wZW4gPSB0cnVlCiAgICAgICAgdGhpcy5jcmVhdGVDYW1lcmFFbGVtZW50KCkKICAgICAgfQogICAgfSwKICAgIHRvZ2dsZUZvcm1VcGxvYWQgKCkgewogICAgICBjb25zb2xlLmxvZygndXNpbmcgdXBsb2FkJykKICAgICAgdGhpcy52aWFVcGxvYWQgPSB0cnVlCiAgICB9LAogICAgY3JlYXRlQ2FtZXJhRWxlbWVudCAoKSB7CiAgICAgIGNvbnN0IGNvbnN0cmFpbnRzID0gKHdpbmRvdy5jb25zdHJhaW50cyA9IHsKICAgICAgICBhdWRpbzogZmFsc2UsCiAgICAgICAgdmlkZW86IHRydWUsCiAgICAgIH0pCiAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMKICAgICAgICAuZ2V0VXNlck1lZGlhKGNvbnN0cmFpbnRzKQogICAgICAgIC50aGVuKHN0cmVhbSA9PiB7CiAgICAgICAgICB0aGlzLiRyZWZzLmNhbWVyYS5zcmNPYmplY3QgPSBzdHJlYW0KICAgICAgICB9KQogICAgICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgICBhbGVydChlcnJvcikKICAgICAgICB9KQogICAgfSwKICAgIHN0b3BDYW1lcmFTdHJlYW0gKCkgewogICAgICBjb25zdCB0cmFja3MgPSB0aGlzLiRyZWZzLmNhbWVyYS5zcmNPYmplY3QuZ2V0VHJhY2tzKCkKICAgICAgdHJhY2tzLmZvckVhY2godHJhY2sgPT4gewogICAgICAgIHRyYWNrLnN0b3AoKQogICAgICB9KQogICAgfSwKICAgIHRha2VQaG90byAoKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCd0YWtpbmcgcGhvdG8nKQogICAgICB0aGlzLmlzUGhvdG9UYWtlbiA9ICF0aGlzLmlzUGhvdG9UYWtlbgogICAgICBjb25zdCBjb250ZXh0ID0gdGhpcy4kcmVmcy5jYW52YXMuZ2V0Q29udGV4dCgnMmQnKQogICAgICBjb250ZXh0LmRyYXdJbWFnZSh0aGlzLiRyZWZzLmNhbWVyYSwgMCwgMCwgNDUwLCAzMzcuNSkKICAgIH0sCiAgICBkb3dubG9hZEltYWdlICgpIHsKICAgICAgaWYgKHRoaXMubmlrID09PSAnJyB8fCB0aGlzLm5hbWEgPT09ICcnKSB7CiAgICAgICAgYWxlcnQoJ1BsZWFzZSBmaWxsIHRoZSBmb3JtIGZpcnN0IGJlZm9yZSBzYXZpbmcgcGhvdG8nKQogICAgICB9IGVsc2UgewogICAgICAgIGNvbnN0IGRvd25sb2FkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rvd25sb2FkUGhvdG8nKQogICAgICAgIGNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwaG90b1Rha2VuJykudG9EYXRhVVJMKCdpbWFnZS9qcGVnJykKICAgICAgICAgIC5yZXBsYWNlKCdpbWFnZS9qcGVnJywgJ2ltYWdlL29jdGV0LXN0cmVhbScpCiAgICAgICAgZG93bmxvYWQuc2V0QXR0cmlidXRlKCdocmVmJywgY2FudmFzKQogICAgICAgIC8vIHBhbmdnaWwgYXBpIHRpYXAgeWFuZyBjZWsgc3RhdHVzIGZpbGUKICAgICAgICB3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgICAgICAgdGhpcy5pc0Rvd25sb2FkU3VjY2Vzcyh0aGlzLm5paykKICAgICAgICB9LCA1MDApCiAgICAgIH0KICAgIH0sCiAgICBpc0Rvd25sb2FkU3VjY2VzcyAobmlrKSB7CiAgICAgIGF4aW9zCiAgICAgICAgLmdldCgnaHR0cDovL2xvY2FsaG9zdDo1MDAwL2Rvd25sb2FkX3N1Y2Nlc3MvJyArIG5paykKICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgICAgICAvLyBjb25zb2xlLmxvZyhyZXNwb25zZS5kYXRhKQogICAgICAgICAgdGhpcy5pbWFnZVNhdmVkID0gcmVzcG9uc2UuZGF0YS5zdGF0dXMgPT09IDIwMAogICAgICAgIH0pCiAgICB9LAogIH0sCn0K"},{"version":3,"sources":["AddEmployee.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddEmployee.vue","sourceRoot":"src/views","sourcesContent":["<!-- eslint-disable -->\n<template>\n  <v-container id=\"attd-list\" fluid tag=\"section\">\n    <v-row justify=\"center\">\n      <v-col \n        cols=\"12\"\n        md=\"12\">\n        <base-material-card\n          icon=\"mdi-account-plus\"\n          title=\"Add Employee\"\n          class=\"px-5 py-3\"\n        > \n          <v-form>\n            <v-container class=\"py-0\">\n              <v-row>\n                <v-col\n                  cols=\"12\"\n                  md=\"6\">\n                  <v-text-field\n                    v-model=\"nik\"\n                    label=\"Employee ID\"\n                    type=\"number\"\n                    outlined\n                  />\n                </v-col>\n                <v-col\n                  cols=\"12\"\n                  md=\"6\">\n                  <v-text-field\n                    v-model=\"nama\"\n                    label=\"Employee Full Name\"\n                    outlined\n                  />\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\" md=\"12\">\n                  <div v-if=\"isCameraOpen\" class=\"camera-box\" align=\"center\">  \n                    <video ref=\"camera\" :width=\"450\" :height=\"337.5\" autoplay></video>\n                    <canvas class=\"ml-3\" v-show=\"isPhotoTaken\" id=\"photoTaken\" ref=\"canvas\" :width=\"450\" :height=\"337.5\"></canvas>\n                  </div>\n                  <div class=\"camera-button\" align=\"center\">\n                    <v-btn :disabled=\"!formFilled || viaLive\" class=\"blue\" @click=\"toggleFormUpload\">\n                      Upload File\n                    </v-btn>\n                    <span class=\"mr-3\">OR</span>\n                    <v-btn :disabled=\"!formFilled || viaUpload\" @click=\"toggleCamera\" :class=\"{ 'success button is-rounded' : !isCameraOpen, 'red button is-rounded' : isCameraOpen}\">\n                      <span v-if=\"!isCameraOpen\">Open Camera</span>\n                      <span v-else>Close Camera</span>\n                    </v-btn>\n                    <v-btn v-if=\"isCameraOpen\" class=\"button\" color=\"blue\" @click=\"takePhoto\">\n                      <span v-if=\"!isPhotoTaken\">Take Photo</span>\n                      <span v-else>Retake Photo</span>\n                    </v-btn>\n                    <v-btn color=\"success\" v-if=\"isCameraOpen && isPhotoTaken\" class=\"camera-download\" @click=\"downloadImage\">\n                      <a style=\"text-decoration:none;color:white;\" id=\"downloadPhoto\" v-bind:download=\"nik + '.jpg'\" class=\"button\" role=\"button\"> \n                        Save Photo\n                      </a>\n                    </v-btn>\n                  </div>\n                </v-col>\n              </v-row>\n              <v-row v-if=\"viaUpload\">\n                <v-col>\n                  <b-form-file\n                    v-model=\"file\"\n                    :state=\"Boolean(file)\"\n                    placeholder=\"Choose a file or drop it here...\"\n                    drop-placeholder=\"Drop file here...\"\n                  ></b-form-file>\n                  <div class=\"mt-3\">Selected file: {{ file ? file.name : '' }}</div>\n                </v-col>\n              </v-row>\n              <v-row>\n                <v-col cols=\"12\" md=\"12\">\n                  <v-btn\n                    block\n                    :disabled=\"!formReadyToSubmit()\"\n                    color=\"success\"\n                    class=\"mr-0\"\n                    @click=\"check\">\n                    submit\n                  </v-btn>\n                </v-col>\n              </v-row>\n            </v-container>\n          </v-form>\n        </base-material-card>\n      </v-col>\n\n    </v-row>\n  </v-container>\n</template>\n\n<script>\n  import axios from 'axios'\n  import { BFormFile } from 'bootstrap-vue'\n  export default {\n    components: {\n      'b-form-file': BFormFile,\n    },\n    data () {\n      return {\n        nik: '',\n        nama: '',\n        video: {},\n        canvas: {},\n        captures: [],\n        isCameraOpen: false,\n        isPhotoTaken: false,\n        imageSaved: false,\n        viaUpload: false,\n        viaLive: null,\n        file: {},\n      }\n    },\n    computed: {\n      formFilled () {\n        return this.nik !== '' && this.nama !== ''\n      },\n    },\n    mounted () {},\n    methods: {\n      check (e) {\n        e.preventDefault()\n        if (this.viaUpload) {\n          const formData = new FormData()\n          formData.append('file', this.file)\n          // You should have a server side REST API\n          axios.post('http://localhost:5000/add_employee_upload/' + this.nik + '/' + this.nama, formData, { headers: { 'Content-Type': 'multipart/form-data' } })\n            .then(() => {\n              console.log('success')\n              location.reload()\n            })\n            .catch(e => {\n              console.log(e.toString())\n              location.reload()\n            })\n        } else {\n          this.stopCameraStream()\n          axios\n            .get('http://localhost:5000/add_employee/' + this.nik + '/' + this.nama)\n            .then(response => {\n              console.log(response)\n              alert('Adding Employee Success!')\n              location.reload()\n            })\n        }\n      },\n      formReadyToSubmit () {\n        if (this.viaUpload) {\n          // kalau via upload, siap submit berarti semua form telah diisi\n          return this.nik !== '' && this.nama !== '' && this.file\n        } else {\n          // kalau via foto live, siap submit berarti semua form telah diisi dan gambar telah tersimpan di Downloads\n          return this.nik !== '' && this.nama !== '' && this.imageSaved && this.isPhotoTaken\n        }\n      },\n      capture () {\n        console.log('capture image')\n      },\n      toggleCamera () {\n        if (this.isCameraOpen) {\n          this.viaLive = false\n          this.isCameraOpen = false\n          this.isPhotoTaken = false\n          this.stopCameraStream()\n        } else {\n          this.viaLive = true\n          this.isCameraOpen = true\n          this.createCameraElement()\n        }\n      },\n      toggleFormUpload () {\n        console.log('using upload')\n        this.viaUpload = true\n      },\n      createCameraElement () {\n        const constraints = (window.constraints = {\n          audio: false,\n          video: true,\n        })\n        navigator.mediaDevices\n          .getUserMedia(constraints)\n          .then(stream => {\n            this.$refs.camera.srcObject = stream\n          })\n          .catch(error => {\n            alert(error)\n          })\n      },\n      stopCameraStream () {\n        const tracks = this.$refs.camera.srcObject.getTracks()\n        tracks.forEach(track => {\n          track.stop()\n        })\n      },\n      takePhoto () {\n        // console.log('taking photo')\n        this.isPhotoTaken = !this.isPhotoTaken\n        const context = this.$refs.canvas.getContext('2d')\n        context.drawImage(this.$refs.camera, 0, 0, 450, 337.5)\n      },\n      downloadImage () {\n        if (this.nik === '' || this.nama === '') {\n          alert('Please fill the form first before saving photo')\n        } else {\n          const download = document.getElementById('downloadPhoto')\n          const canvas = document.getElementById('photoTaken').toDataURL('image/jpeg')\n            .replace('image/jpeg', 'image/octet-stream')\n          download.setAttribute('href', canvas)\n          // panggil api tiap yang cek status file\n          window.setInterval(() => {\n            this.isDownloadSuccess(this.nik)\n          }, 500)\n        }\n      },\n      isDownloadSuccess (nik) {\n        axios\n          .get('http://localhost:5000/download_success/' + nik)\n          .then(response => {\n            // console.log(response.data)\n            this.imageSaved = response.data.status === 200\n          })\n      },\n    },\n  }\n</script>\n\n<style>\n</style>\n"]}]}